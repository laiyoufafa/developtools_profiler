select
      distinct process_view.pid as pid,
      process_view.name as processName
    from (
      select ipid, itid from sched_slice join thread_view using(itid) group by itid
    ) the_tracks
    left join (select ipid, sum(dur) as total_dur
      from sched_view join thread_view using(itid)
      group by ipid
    ) using(ipid)
    left join process_view using(ipid)
    order by
      total_dur desc,
      the_tracks.ipid,
     processName,
      the_tracks.itid;