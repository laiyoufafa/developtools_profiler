select
                      the_tracks.ipid as upid,
                      the_tracks.itid as utid,
                      total_dur as hasSched,
                      process_view.pid as pid,
                      thread_view.tid as tid,
                      process_view.name as processName,
                      thread_view.name as threadName
                    from (
                      select ipid, itid from sched_view join thread_view using(itid) group by itid
                    ) the_tracks
                    left join (select ipid, sum(dur) as total_dur
                      from sched_view join thread_view using(itid)
                      group by ipid
                    ) using(ipid)
                    left join thread_view using(itid)
                    left join process_view using(ipid)
                    where  pid = %s
                    order by
                      total_dur desc,
                      the_tracks.ipid,
                      the_tracks.itid